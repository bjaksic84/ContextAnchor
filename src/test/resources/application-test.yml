# Test configuration - Testcontainers manages PostgreSQL
spring:
  datasource:
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: true
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
  ai:
    openai:
      api-key: test-key-not-used
      chat:
        options:
          model: gpt-4o-mini
          temperature: 0.3
      embedding:
        options:
          model: text-embedding-3-small
    vectorstore:
      pgvector:
        dimensions: 1536
        index-type: hnsw
        distance-type: cosine_distance

security:
  jwt:
    secret: test-secret-key-for-unit-tests-minimum-32-characters-long
    access-token-expiration: 900000
    refresh-token-expiration: 604800000

rag:
  ai:
    provider: openai    # tests use stub beans regardless of provider
  rate-limit:
    enabled: false
  chunking:
    chunk-size: 800
    chunk-overlap: 200
    min-chunk-size: 100
  upload:
    storage-path: ./test-uploads
    allowed-types:
      - application/pdf
      - text/plain
      - application/vnd.openxmlformats-officedocument.wordprocessingml.document
  chat:
    max-history-size: 10
    top-k-results: 5
    system-prompt: Test system prompt

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
